---
###########################################
## REQUIRED INPUT
##
## The qcow image you would like to deploy
## this file must be downloaded to Libvirt pool directory
## the default is /var/lib/libvirt/images
## EXAMPLE: rhel-server-7.6-x86_64-kvm.qcow2
vm_qcow_image: ""

## Libvirt OS Release
## Tested:
##  - rhel7,rhel8
##  - fedora31
##  - windows: win2k12r2
## to see complete list: osinfo-query os or osinfo-query os | awk '/rhel[7-8]/ {print $1}'
os_release: ""

## The default RHEL user and password
admin_user: ""
admin_user_password: ""

## Password to set for the root user
kvm_vm_root_pwd: ""

## Your ssh public key
vm_public_key: "/home/{{ admin_user }}/.ssh/id_rsa.pub"

## What to name the VM
vm_name: ""

## How to register RHEL system you can provider username/password or
## activation key/org
rhsm_username: ""
rhsm_password: ""
rhsm_activationkey: ""
rhsm_org: ""

## Specify the major release number for RHEL
## Tested: 7 and 8
rhel_release: ""

##############################
## Defaults - change if needed
##
## Resources to assign to VM
vm_cpu: 2

## memmory is megabytes
vm_memory: 1024

## disk size in gigabytes
vm_root_disk_size: 10G

## set this to yes if you change vm_root_disk_size is larger that 10G
expand_os_disk: no

## Your local domain
vm_domain: ""

## Extra disk for VMs, set enable to true along with size
extra_storage:
  - size: 80G
    enable: false
  - size: 50G
    enable: false

## the kvm nic is usually always eth
vm_nic: "eth0"

## When this var is set to true and the host gets it's ip address from
## dhcp. It was take that IP address and configure the host to use static
## ip address assignment. It's recommended that you create a DHCP reservation
## for this host to ensure the DHCP lease does not expire and get consume by 
## another host on the network.
convert_dhcp_to_static: no

## VM Networking: DHCP is used by default
## Any value entered for the below varaibles will be used instead
vm_gateway: ""
vm_ipaddress: ""
vm_netmask: ""
vm_mac: ""

## Set to true to delete the VM
vm_teardown: false

## Files and script generated by the role are stored here
vm_data_dir: "/var/lib/vmdata"

## Local to storage VM qcow disk
kvm_vm_pool_dir: "/var/lib/libvirt/images"

## Libvirt network to use
vm_libvirt_net: default

## DNS servers
dns_servers:
  - 1.1.1.1
  - 8.8.8.8

## Setup /etc/resolve
nameservers: "{{ dns_servers }}"

# Windoes OS info
#os_release: "win2k12r2"
#os_type: "windows"
#graphics: "vnc"

# If you have a static ansible inventory this role
# can populate with the newly created VM
update_inventory: yes
inventory_file: ""
inventory_group: ""

# Qemu preallocation, options are: metadata, falloc, full
qemu_img_allocation: falloc

#########################
## NO CHANGE REQUIRED
required_packages:
  - python3-netaddr

vm_local_hostname: "{{ vm_name }}.{{ vm_domain }}"
vm_hostname: "{{ vm_local_hostname }}"
# get list of os variants
# $ osinfo-query os
os_variant: "{{ os_release }}"
vm_ifcfg: "{{ vm_data_dir }}/{{ vm_name }}/ifcfg"
vm_virtinstall_script: "{{ vm_data_dir }}/{{ vm_name }}/virtinstall.sh"
vm_ifcfg_file: "{{ vm_data_dir }}/{{ vm_name }}/ifcfg-{{ vm_nic.stdout }}"
vm_virtinstall_net_opts: "network={{ vm_libvirt_net }}"
search_domains: 
  - "{{ vm_domain }}"
os_disk: "{{ kvm_vm_pool_dir }}/{{ vm_name }}_vda.qcow2"
os_qcow_template: "{{ kvm_vm_pool_dir }}/{{ vm_qcow_image }}"
extra_disk_name: "{{ kvm_vm_pool_dir }}/{{ vm_name }}"
disk_sequence: "bcdefghijklmnopqrstuvwxyz"
vm_resolv_conf: "{{ vm_data_dir }}/{{ vm_name }}/resolv.conf"
# Cloud-init 
cloud_init_user_data: "{{ vm_data_dir }}/{{ vm_name }}/user-data"
cloud_init_meta_data: "{{ vm_data_dir }}/{{ vm_name }}/meta-data"
cloud_init_network_config: "{{ vm_data_dir }}/{{ vm_name }}/network-config"
cloud_init_configs: "{{ cloud_init_user_data }} {{ cloud_init_meta_data }}"
cidata_iso_name: cidata.iso
cloud_init_iso_image: "{{ vm_data_dir }}/{{ vm_name }}/{{ cidata_iso_name }}"
qcow_rhel_release: "{{ rhel_release | default('8') }}"
ip_and_mask: "{{ vm_ipaddress }}/{{ vm_netmask }}"
vm_cidr: "{{ ip_and_mask | ipaddr('prefix') }}"
